# ğŸ§  P1ï¼šäºˆæ¸¬ AI (MVP) æŠ€è¡“ä»•æ§˜ãƒ»æ¤œè¨¼ãƒ¬ãƒãƒ¼ãƒˆ

**ä½œæˆæ—¥:** 2025 å¹´ 11 æœˆ 19 æ—¥  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:** ä»•æ§˜ç¢ºèªå®Œäº† âœ…  
**æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:** P1-3-B (MCTS Engine) å®Ÿè£…é–‹å§‹ ğŸ”¥

---

## ğŸ¯ P1 ãƒ•ã‚§ãƒ¼ã‚ºã®ã‚´ãƒ¼ãƒ«

PBS å½¢å¼ã®è¦³æˆ¦ä½“é¨“ã«å¿…è¦ãªæ ¸ã¨ãªã‚‹ãƒ‡ãƒ¼ã‚¿ï¼ˆé…åˆ†ã€ç¢ºå®šæ•°ã€å‹ç‡ã€é‡è¦åº¦ï¼‰ã‚’ã€**ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ç®—å‡ºå¯èƒ½ãªçŠ¶æ…‹ã«ã™ã‚‹ã€‚**

---

## ğŸ“‹ æŠ€è¡“ä»•æ§˜ã¨å®Ÿè£…çŠ¶æ³ã®å¯¾å¿œè¡¨

### 1. é…åˆ†äºˆæ¸¬ã‚¨ãƒ³ã‚¸ãƒ³ (Opponent EV Build Estimator)

| é …ç›®             | è¦ä»¶                                                 | å®Ÿè£…çŠ¶æ³ | ãƒ•ã‚¡ã‚¤ãƒ«                                       | æ¤œè¨¼çµæœ                                                          |
| :--------------- | :--------------------------------------------------- | :------- | :--------------------------------------------- | :---------------------------------------------------------------- |
| **å…¥åŠ›ãƒ‡ãƒ¼ã‚¿**   | ç¨®æ—åã€è¡Œå‹•ãƒ­ã‚°ã€å¤©å€™/ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰                    | âœ… å®Œäº†  | `predictor/core/detective_engine.py`           | `SpreadHypothesis` ã‚¯ãƒ©ã‚¹ã§ç®¡ç†                                   |
| **ã‚³ã‚¢ãƒ­ã‚¸ãƒƒã‚¯** | ãƒ™ã‚¤ã‚ºæ›´æ–° (Bayesian Update)                         | âœ… å®Œäº†  | `predictor/core/detective_engine.py` (L95-476) | `update_from_speed_comparison()`, `update_from_damage()` å®Ÿè£…æ¸ˆã¿ |
| **åˆæœŸçŠ¶æ…‹**     | Smogon Chaos JSON ã‹ã‚‰ Prior ãƒ­ãƒ¼ãƒ‰                  | âœ… å®Œäº†  | `predictor/data/smogon_chaos_parser.py`        | `load_prior()` ã§ TOP5 ã‚’ç¢ºç‡åˆ†å¸ƒåŒ–                               |
| **å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿**   | `Dict[PokemonSpecies, List[Tuple[EV_Spread, Prob]]]` | âœ… å®Œäº†  | `predictor/core/detective_engine.py` (L400+)   | `get_all_hypotheses()` ã§ç¢ºç‡åˆ†å¸ƒå‡ºåŠ›                             |
| **æ©Ÿèƒ½æ¤œè¨¼**     | è¢«ãƒ€ãƒ¡å‰å¾Œã®ç¢ºç‡å¤‰åŒ–                                 | âœ… å®Œäº†  | `tests/test_detective_engine.py`               | ãƒ†ã‚¹ãƒˆæ¸ˆã¿ (2025/11/17)                                           |

**ğŸ“Š å®Œæˆåº¦:** 100% âœ…

**ğŸ”§ çµ±åˆçŠ¶æ…‹:**

- `predictor/core/position_evaluator.py` ãŒ `EVEstimator` çµŒç”±ã§ Detective Engine ã‚’å‘¼ã³å‡ºã—
- `evaluate_position()` é–¢æ•°ã§å…¨ä½“çµ±åˆæ¸ˆã¿

---

### 2. ãƒ€ãƒ¡ãƒ¼ã‚¸ãƒ¬ãƒ³ã‚¸è¨ˆç®— (Damage Simulator)

| é …ç›®             | è¦ä»¶                               | å®Ÿè£…çŠ¶æ³ | ãƒ•ã‚¡ã‚¤ãƒ«                                              | æ¤œè¨¼çµæœ                                            |
| :--------------- | :--------------------------------- | :------- | :---------------------------------------------------- | :-------------------------------------------------- |
| **å…¥åŠ›ãƒ‡ãƒ¼ã‚¿**   | æ¨å®š EV åˆ†å¸ƒã€æŠ€ IDã€ä¹±æ•°æƒ…å ±      | âœ… å®Œäº†  | `predictor/engine/smogon_calc_wrapper.py`             | `SmogonDamageResult` ã‚¯ãƒ©ã‚¹ã§ç®¡ç†                   |
| **ã‚³ã‚¢ãƒ­ã‚¸ãƒƒã‚¯** | @smogon/calc çµ±åˆ                  | âœ… å®Œäº†  | `smogon-calc-bridge/calc_server.js` + Python ãƒ©ãƒƒãƒ‘ãƒ¼ | Node.js ãƒ–ãƒªãƒƒã‚¸çµŒç”±ã§å‘¼ã³å‡ºã—                      |
| **å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿**   | Min/Max Damage (%), OHKO/2HKO ç¢ºç‡ | âœ… å®Œäº†  | `SmogonDamageResult.damage_range`, `kochance`         | ä¹±æ•° 16 é€šã‚Š + ç¢ºç‡åˆ†å¸ƒ                             |
| **æ©Ÿèƒ½æ¤œè¨¼**     | ç¢ºå®š 1 ç™º/ä¹±æ•° 50%ã®è¨ˆç®—ç²¾åº¦       | âœ… å®Œäº†  | `tests/test_smogon_calc_wrapper.py`                   | Gholdengo vs Dragonite ã§æ¤œè¨¼æ¸ˆã¿ (85-101 ãƒ€ãƒ¡ãƒ¼ã‚¸) |

**ğŸ“Š å®Œæˆåº¦:** 100% âœ…

**ğŸ”§ çµ±åˆçŠ¶æ…‹:**

- `predictor/engine/damage_calculator.py` (æ—§å®Ÿè£…ã€éæ¨å¥¨) â†’ `smogon_calc_wrapper.py` ã«ç§»è¡Œå®Œäº†
- `predictor/engine/action_annotator.py` ã§ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—ã‚’å„è¡Œå‹•ã«ç´ä»˜ã‘
- Multiscaleã€ãƒ†ãƒ©ã‚¹ã‚¿ãƒ«ç­‰ã™ã¹ã¦å¯¾å¿œæ¸ˆã¿

**ğŸ“„ è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ:** `docs/phase1_2_smogon_calc_integration.md`

---

### 3. å‹ç‡æ¨å®š & æœ€é©è¡Œå‹• (Win Probability Model)

**ğŸ”„ æˆ¦ç•¥å¤‰æ›´ (2025/11/19):** ãƒ‡ãƒ¼ã‚¿ä¸è¶³ã«ã‚ˆã‚Šãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’å»ƒæ­¢ â†’ **MCTS + Expert System ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰**ã«å¤‰æ›´

| é …ç›®            | è¦ä»¶                         | å®Ÿè£…çŠ¶æ³  | ãƒ•ã‚¡ã‚¤ãƒ«                                            | å„ªå…ˆåº¦          |
| :-------------- | :--------------------------- | :-------- | :-------------------------------------------------- | :-------------- |
| **âŒ æ—§è¨ˆç”»**   | Neural Network (PyTorch)     | **å»ƒæ­¢**  | -                                                   | -               |
| **âœ… æ–°æˆ¦ç•¥ A** | **Fast-Lane: Expert System** | â³ æœªå®Ÿè£… | `predictor/player/fast_strategist.py` (äºˆå®š)        | **HIGH**        |
| **âœ… æ–°æˆ¦ç•¥ B** | **Slow-Lane: MCTS Engine**   | â³ æœªå®Ÿè£… | `predictor/player/monte_carlo_strategist.py` (äºˆå®š) | **ğŸ”¥ CRITICAL** |

#### 3-A. Fast-Lane: Expert System (P1-3-A)

| é …ç›®             | è¦ä»¶                                         | æŠ€è¡“è©³ç´°                            |
| :--------------- | :------------------------------------------- | :---------------------------------- |
| **æ‰‹æ³•**         | LightGBM / ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°                | 760 ä»¶ã®ãƒªãƒ—ãƒ¬ã‚¤ã§è¨“ç·´              |
| **å¿œç­”æ™‚é–“**     | **10ms ä»¥å†…**                                | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  UI è¡¨ç¤ºç”¨              |
| **å…¥åŠ›ãƒ™ã‚¯ãƒˆãƒ«** | HP æ®‹é‡ã€çŠ¶æ…‹ç•°å¸¸ã€æ¨å®š EVã€å¤©å€™ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | L1, L2 ã®çµæœã‚’å›ºå®šé•·ãƒ™ã‚¯ãƒˆãƒ«åŒ–     |
| **å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿**   | Win Probability (0.0-1.0)                    | UI ã«å³æ™‚è¡¨ç¤º                       |
| **å®Ÿè£…äºˆå®š**     | Week 2 (5 æ—¥é–“)                              | ç‰¹å¾´é‡æŠ½å‡º â†’ ãƒ¢ãƒ‡ãƒ«è¨“ç·´ â†’ 10ms æ¤œè¨¼ |

#### 3-B. Slow-Lane: MCTS Engine (P1-3-B) ğŸ”¥ æœ€å„ªå…ˆ

| é …ç›®             | è¦ä»¶                                              | æŠ€è¡“è©³ç´°                                           |
| :--------------- | :------------------------------------------------ | :------------------------------------------------- |
| **æ‰‹æ³•**         | **ãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­ãƒ»ãƒ­ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ**                    | ç¾åœ¨ã®ç›¤é¢ã‹ã‚‰è©¦åˆçµ‚äº†ã¾ã§ 1000 å›ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ |
| **è©¦è¡Œå›æ•°**     | 500ã€œ1,000 å›/ã‚¿ãƒ¼ãƒ³                              | è¨ˆç®—ã‚³ã‚¹ãƒˆã¨ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ã®ãƒãƒ©ãƒ³ã‚¹               |
| **å…¥åŠ›ãƒ™ã‚¯ãƒˆãƒ«** | HPã€æ®‹æ•°ã€çŠ¶æ…‹ç•°å¸¸ã€**æ¨å®š EV**ã€å¤©å€™ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | L1, L2 ã®çµæœã‚’å«ã‚€                                |
| **è©•ä¾¡é–¢æ•°**     | æ—¢å­˜ã® `PositionEvaluator` ã‚’æ´»ç”¨                 | ãƒ’ãƒ¥ãƒ¼ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯è©•ä¾¡ (L2 çµ±åˆæ¸ˆã¿)               |
| **æœ€é©è¡Œå‹•**     | 1000 å›ã®è©¦è¡Œã§æœ€ã‚‚å‹ç‡ã®é«˜ã„è¡Œå‹•                 | Policy Head ã®ä»£ã‚ã‚Š                               |
| **å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿**   | Win Probability, Optimal Move ID, Win Rate (%)    | ã€Œã‚°ãƒ©ã‚¹ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ 53%ã€ã®æ ¹æ‹                      |
| **å®Ÿè£…äºˆå®š**     | **Week 1 (5 æ—¥é–“)** ğŸ”¥                            | `monte_carlo_strategist.py` ä½œæˆ                   |

**ğŸ“Š å®Œæˆåº¦:** 0% â³ (Week 1 ã§å®Ÿè£…é–‹å§‹)

**ğŸ¯ æ—¢å­˜ã®åŸºç›¤:**

- âœ… `predictor/core/position_evaluator.py` - è©•ä¾¡é–¢æ•°ã¨ã—ã¦åˆ©ç”¨å¯èƒ½
- âœ… `predictor/core/eval_algorithms/heuristic_eval.py` - ãƒ’ãƒ¥ãƒ¼ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯è©•ä¾¡å®Ÿè£…æ¸ˆã¿
- âœ… `predictor/engine/state_rebuilder.py` - ãƒãƒˆãƒ«çŠ¶æ…‹ã®å†æ§‹ç¯‰å¯èƒ½
- â³ `poke-env` + Showdown ã‚µãƒ¼ãƒãƒ¼ - ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åŸºç›¤ (çµ±åˆå¿…è¦)

**ğŸš€ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:**

1. `predictor/player/monte_carlo_strategist.py` ä½œæˆ
2. MCTS åŸºæœ¬ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å®Ÿè£… (ãƒ©ãƒ³ãƒ€ãƒ ãƒ­ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ)
3. `PositionEvaluator` ã¨ã®çµ±åˆ
4. 1000 rollouts ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ

---

### 4. é‡è¦ã‚¿ãƒ¼ãƒ³æ¨å®š (Excitement Detector)

| é …ç›®             | è¦ä»¶                                              | å®Ÿè£…çŠ¶æ³    | ãƒ•ã‚¡ã‚¤ãƒ«                            | æ¤œè¨¼çµæœ                          |
| :--------------- | :------------------------------------------------ | :---------- | :---------------------------------- | :-------------------------------- |
| **ã‚³ã‚¢ãƒ­ã‚¸ãƒƒã‚¯** | å‹ç‡å¤‰å‹•ç‡ (Î”WP >= 15%)                           | âœ… å®Œäº†     | `frontend/streamlit_app.py` (L270+) | `is_critical_turn` ãƒ•ãƒ©ã‚°å®Ÿè£…æ¸ˆã¿ |
| **è£œåŠ©ãƒ­ã‚¸ãƒƒã‚¯** | ä¹±æ•°ä¾å­˜åº¦ (30%ã€œ70%)                             | â³ éƒ¨åˆ†å®Ÿè£… | L2 ã®ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—çµæœã‚’å‚ç…§         | UI çµ±åˆå¾…ã¡                       |
| **å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿**   | `is_exciting: Boolean`, `excitement_score: Float` | âœ… å®Œäº†     | `EvaluationResult.is_critical_turn` | Streamlit ã§ CRITICAL TURN è¡¨ç¤º   |

**ğŸ“Š å®Œæˆåº¦:** 80% ğŸ”„ (åŸºæœ¬ãƒ­ã‚¸ãƒƒã‚¯å®Œæˆã€è£œåŠ©ãƒ­ã‚¸ãƒƒã‚¯çµ±åˆå¾…ã¡)

**ğŸ”§ çµ±åˆçŠ¶æ…‹:**

- Streamlit UI ã§ã€ŒCRITICAL TURN ğŸš¨ã€ãƒãƒƒã‚¸è¡¨ç¤ºå®Ÿè£…æ¸ˆã¿
- å‹ç‡å¤‰å‹•ç‡ã®è¨ˆç®—ã¯ `predictor/core/models.py` ã§å®Ÿè£…

---

### 5. æœ€ä½é™ UI (æŠ€è¡“æ¤œè¨¼ç”¨)

| é …ç›®                 | è¦ä»¶                           | å®Ÿè£…çŠ¶æ³  | ãƒ•ã‚¡ã‚¤ãƒ«                               | æ¤œè¨¼çµæœ                     |
| :------------------- | :----------------------------- | :-------- | :------------------------------------- | :--------------------------- |
| **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€£æº** | è¦³æˆ¦ Bot â†’ UI å³æ™‚åæ˜          | âœ… å®Œäº†   | `frontend/streamlit_app.py`            | http://localhost:8501 ã§å‹•ä½œ |
| **å‹ç‡ã‚°ãƒ©ãƒ•**       | ã‚¿ãƒ¼ãƒ³ã”ã¨ã® WP ã‚’æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ• | âœ… å®Œäº†   | `render_win_rate_history()` (L200+)    | Plotly ã§å®Ÿè£…                |
| **é…åˆ†ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—** | EV å€™è£œã®ç¢ºç‡ã‚’å¯è¦–åŒ–          | â³ æœªå®Ÿè£… | -                                      | P1-3-D (UI çµ±åˆ) ã§å®Ÿè£…äºˆå®š  |
| **æœ€é©è¡Œå‹•æç¤º**     | L3 ã®æœ€é©è¡Œå‹•ã¨ WP å€¤          | âœ… å®Œäº†   | `render_recommended_actions()` (L300+) | æ¨å¥¨è¡Œå‹•ã‚«ãƒ¼ãƒ‰è¡¨ç¤º           |

**ğŸ“Š å®Œæˆåº¦:** 75% ğŸ”„ (é…åˆ†ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ä»¥å¤–ã¯å®Œæˆ)

**ğŸ¨ å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½:**

- âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‹ç‡ã‚²ãƒ¼ã‚¸ (Player A vs Player B)
- âœ… ã‚¿ãƒ¼ãƒ³æ¨ç§»ã‚°ãƒ©ãƒ• (Plotly)
- âœ… æ¨å¥¨è¡Œå‹•ã‚«ãƒ¼ãƒ‰ (ãƒã‚¤ãƒ©ã‚¤ãƒˆè¡¨ç¤º)
- âœ… CRITICAL TURN æ¤œçŸ¥ãƒãƒƒã‚¸
- âœ… ç›¤é¢çŠ¶æ…‹è¡¨ç¤º (HPã€çŠ¶æ…‹ç•°å¸¸ã€å¤©å€™)

**ğŸš€ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ (P1-3-D):**

- é…åˆ†ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ã®è¿½åŠ  (Detective Engine ã®ç¢ºç‡åˆ†å¸ƒã‚’å¯è¦–åŒ–)
- MCTS ã®æœ€é©æ‰‹ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°

---

## ğŸ“Š Phase 1 å…¨ä½“ã®å®Œæˆåº¦

```
Phase 1: Logic Core MVP           â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  55% ğŸ”„

  â”œâ”€ 1. é…åˆ†äºˆæ¸¬ã‚¨ãƒ³ã‚¸ãƒ³           â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…
  â”œâ”€ 2. ãƒ€ãƒ¡ãƒ¼ã‚¸ãƒ¬ãƒ³ã‚¸è¨ˆç®—         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…
  â”œâ”€ 3. å‹ç‡æ¨å®š & æœ€é©è¡Œå‹•        â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   0% â³
  â”‚   â”œâ”€ P1-3-A: Fast-Lane        â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   0% (Week 2äºˆå®š)
  â”‚   â””â”€ P1-3-B: Slow-Lane (MCTS) â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   0% ğŸ”¥Week 1æœ€å„ªå…ˆ
  â”œâ”€ 4. é‡è¦ã‚¿ãƒ¼ãƒ³æ¨å®š             â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  80% ğŸ”„
  â””â”€ 5. æœ€ä½é™UI                   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘  75% ğŸ”„
```

---

## âœ… ä»•æ§˜ç¢ºèªçµæœ: æ‰¿èªäº‹é …

### ğŸ¯ æç¤ºã„ãŸã ã„ãŸä»•æ§˜æ›¸ã®è©•ä¾¡

| è¦³ç‚¹                | è©•ä¾¡       | ã‚³ãƒ¡ãƒ³ãƒˆ                                                                |
| :------------------ | :--------- | :---------------------------------------------------------------------- |
| **1. é…åˆ†äºˆæ¸¬**     | â­â­â­â­â­ | å®Œç’§ã€‚æ—¢å­˜å®Ÿè£…ã¨å®Œå…¨ä¸€è‡´ã€‚Smogon Chaos JSON ã® Prior ãƒ­ãƒ¼ãƒ‰ã‚‚å®Ÿè£…æ¸ˆã¿ã€‚ |
| **2. ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—** | â­â­â­â­â­ | å®Œç’§ã€‚@smogon/calc çµ±åˆæ¸ˆã¿ã§ 100%æ­£ç¢ºã€‚ä¹±æ•° 16 é€šã‚Š + ç¢ºç‡åˆ†å¸ƒã‚‚å¯¾å¿œã€‚ |
| **3. å‹ç‡æ¨å®š**     | â­â­â­â­â­ | **æˆ¦ç•¥å¤‰æ›´ã‚’åæ˜ æ¸ˆã¿**ã€‚MCTS ä¸­å¿ƒã®æ–°ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«å®Œå…¨å¯¾å¿œã€‚             |
| **4. é‡è¦ã‚¿ãƒ¼ãƒ³**   | â­â­â­â­â˜†  | åŸºæœ¬ãƒ­ã‚¸ãƒƒã‚¯å®Œæˆã€‚è£œåŠ©ãƒ­ã‚¸ãƒƒã‚¯ (ä¹±æ•°ä¾å­˜åº¦) ã¯çµ±åˆå¾…ã¡ã€‚                |
| **5. UI**           | â­â­â­â­â˜†  | Streamlit MVP å®Œæˆã€‚é…åˆ†ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ã®ã¿æœªå®Ÿè£…ã€‚                        |

### ğŸš€ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ (3 é€±é–“)

#### Week 1: MCTS Engine å®Ÿè£… (P1-3-B) ğŸ”¥ æœ€å„ªå…ˆ

| Day   | ã‚¿ã‚¹ã‚¯                       | æˆæœç‰©                                       |
| :---- | :--------------------------- | :------------------------------------------- |
| Day 1 | MCTS åŸºæœ¬è¨­è¨ˆ + ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ | `predictor/player/monte_carlo_strategist.py` |
| Day 2 | ãƒ©ãƒ³ãƒ€ãƒ ãƒ­ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆå®Ÿè£…     | `rollout()` ãƒ¡ã‚½ãƒƒãƒ‰ (1000 å›è©¦è¡Œ)           |
| Day 3 | `PositionEvaluator` çµ±åˆ     | è©•ä¾¡é–¢æ•°ã¨ã—ã¦çµ„ã¿è¾¼ã¿                       |
| Day 4 | ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–         | ä¸¦åˆ—åŒ–ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥                           |
| Day 5 | ãƒ†ã‚¹ãƒˆ & ãƒ‡ãƒãƒƒã‚°            | `tests/test_monte_carlo_strategist.py`       |

#### Week 2: Fast-Lane å®Ÿè£… (P1-3-A)

| Day     | ã‚¿ã‚¹ã‚¯                  | æˆæœç‰©                                               |
| :------ | :---------------------- | :--------------------------------------------------- |
| Day 1-2 | ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°  | `predictor/player/feature_extractor.py` (760 ä»¶ä½¿ç”¨) |
| Day 3-4 | LightGBM è¨“ç·´ & è©•ä¾¡    | `predictor/player/fast_strategist.py`                |
| Day 5   | 10ms ä»¥å†…ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ¤œè¨¼ | ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆ                                   |

#### Week 3: çµ±åˆ & UI (P1-3-C/D)

| Day     | ã‚¿ã‚¹ã‚¯                         | æˆæœç‰©                                  |
| :------ | :----------------------------- | :-------------------------------------- |
| Day 1-2 | Fast/Slow ä¸¦åˆ—å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ | `predictor/player/hybrid_strategist.py` |
| Day 3-4 | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰çµ±åˆ             | é…åˆ†ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ— + MCTS æœ€é©æ‰‹è¡¨ç¤º      |
| Day 5   | ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ         | Phase 1 å®Œäº†æ¤œè¨¼                        |

---

## ğŸ”¥ å³åº§ã«é–‹å§‹å¯èƒ½: P1-3-B å®Ÿè£…

### å®Ÿè£…ä»•æ§˜: `monte_carlo_strategist.py`

```python
"""
Monte Carlo Strategist: MCTS Engine

ç¾åœ¨ã®ç›¤é¢ã‹ã‚‰1000å›ã®ãƒ©ãƒ³ãƒ€ãƒ ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã€
æœ€ã‚‚å‹ç‡ã®é«˜ã„è¡Œå‹•ã‚’è¿”ã™ã€‚
"""

from typing import Dict, List, Tuple
from predictor.core.position_evaluator import evaluate_position
from predictor.core.models import BattleState, Action

class MonteCarloStrategist:
    """ãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­æ¢ç´¢ã«ã‚ˆã‚‹å‹ç‡äºˆæ¸¬"""

    def __init__(self, n_rollouts: int = 1000):
        """
        Args:
            n_rollouts: ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è©¦è¡Œå›æ•°
        """
        self.n_rollouts = n_rollouts

    def predict_win_rate(self, battle_state: BattleState) -> Dict[str, float]:
        """
        ç¾åœ¨ã®ç›¤é¢ã‹ã‚‰å‹ç‡ã‚’äºˆæ¸¬

        Returns:
            {"player_a": 0.53, "player_b": 0.47}
        """
        # å„è¡Œå‹•ã«ã¤ã„ã¦ n_rollouts / len(actions) å›ãšã¤è©¦è¡Œ
        actions = self._get_legal_actions(battle_state)
        win_counts = {action: 0 for action in actions}

        for action in actions:
            trials_per_action = self.n_rollouts // len(actions)
            for _ in range(trials_per_action):
                result = self._simulate_battle(battle_state, action)
                if result == "player_a_win":
                    win_counts[action] += 1

        # æœ€ã‚‚å‹ç‡ã®é«˜ã„è¡Œå‹•ã‚’ç‰¹å®š
        best_action = max(win_counts, key=win_counts.get)
        win_rate = win_counts[best_action] / (self.n_rollouts // len(actions))

        return {
            "player_a": win_rate,
            "player_b": 1 - win_rate,
            "optimal_action": best_action,
            "optimal_action_win_rate": win_rate
        }

    def _simulate_battle(self, state: BattleState, first_action: Action) -> str:
        """
        ãƒãƒˆãƒ«ã‚’æœ€å¾Œã¾ã§ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

        Returns:
            "player_a_win" or "player_b_win"
        """
        # TODO: poke-env + Showdown ã‚µãƒ¼ãƒãƒ¼ã§ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
        # è©•ä¾¡é–¢æ•°ã¨ã—ã¦ PositionEvaluator ã‚’ä½¿ç”¨
        pass

    def _get_legal_actions(self, state: BattleState) -> List[Action]:
        """åˆæ³•æ‰‹ã‚’å–å¾—"""
        # TODO: å®Ÿè£…
        pass
```

---

## ğŸ“ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

**âœ… ä»•æ§˜ç¢ºèªå®Œäº†** â†’ **ğŸ”¥ P1-3-B å®Ÿè£…é–‹å§‹**

æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§ä½œæ¥­ã‚’é–‹å§‹ã§ãã¾ã™:

```bash
# 1. MCTS Engine ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
touch predictor/player/monte_carlo_strategist.py

# 2. ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
touch tests/test_monte_carlo_strategist.py

# 3. å®Ÿè£…é–‹å§‹
code predictor/player/monte_carlo_strategist.py
```

---

## ğŸ“š å‚è€ƒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- **ãƒã‚¹ã‚¿ãƒ¼ãƒ—ãƒ©ãƒ³:** `docs/PBS-AI_Ultimate_Master_Plan.md`
- **ForAgentRead:** `ForAgentRead.md` (Phase 1.3 æ–°æˆ¦ç•¥åæ˜ æ¸ˆã¿)
- **Phase 1.2 å®Œäº†å ±å‘Š:** `docs/phase1_2_smogon_calc_integration.md`
- **ãƒ‡ãƒ¼ã‚¿åé›†å®Œäº†å ±å‘Š:** `docs/251119_phase1_3_data_collection_report.md`

---

**Status:** ğŸŸ¢ Ready to Start P1-3-B Implementation  
**Priority:** ğŸ”¥ CRITICAL - Week 1 (5 days)  
**Dependencies:** âœ… All prerequisites met (Detective, Simulator, Evaluator å®Œæˆæ¸ˆã¿)
