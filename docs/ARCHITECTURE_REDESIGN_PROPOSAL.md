# ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å†è¨­è¨ˆææ¡ˆæ›¸

> **ç›®çš„**: å¤–éƒ¨ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‹ã‚‰ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’åŸºã«ã€å¯¾æˆ¦AI/è¦³æˆ¦AIã®åˆ†é›¢ã¨BeliefStateå°å…¥ã«å‘ã‘ãŸç¾çŠ¶åˆ†æã¨å†è¨­è¨ˆæ–¹é‡ã‚’ã¾ã¨ã‚ã‚‹ã€‚

**ä½œæˆæ—¥**: 2025-12-29

---

## ğŸ“‹ ç›®æ¬¡

1. [å¤–éƒ¨ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯è¦ç´„](#1-å¤–éƒ¨ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯è¦ç´„)
2. [ç¾çŠ¶ã‚³ãƒ¼ãƒ‰ã®å•é¡Œç‚¹](#2-ç¾çŠ¶ã‚³ãƒ¼ãƒ‰ã®å•é¡Œç‚¹)
3. [å†è¨­è¨ˆæ–¹é‡](#3-å†è¨­è¨ˆæ–¹é‡)
4. [å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—](#4-å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—)

---

## 1. å¤–éƒ¨ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯è¦ç´„

### 1.1 æœ€é‡è¦æŒ‡æ‘˜

> **ã€Œå¯¾æˆ¦AIã€ã¨ã€Œè¦³æˆ¦AIï¼ˆæ¨å®šï¼‹è¡¨ç¤ºï¼‰ã€ã‚’åˆ¥ç‰©ã¨ã—ã¦è¨­è¨ˆã—ç›´ã™ã“ã¨**

- è¦³æˆ¦ã¯ã€Œæ¨å®šå•é¡Œã€ã€å¯¾æˆ¦ã¯ã€Œæ„æ€æ±ºå®šå•é¡Œã€ã€‚åˆ¥æœ€é©ã€‚
- åŒã˜BattleStateã§ä¸¡æ–¹å›ãã†ã¨ã—ã¦ã„ã‚‹ã®ãŒç„¡ç†ç­‹ã€‚

### 1.2 BattleStateäºŒå±¤åŒ–ã®å¿…è¦æ€§

ç¾çŠ¶ï¼šBattleState ã‚’ã€Œç¢ºå®šã®çŠ¶æ…‹ã€ã¨ã—ã¦æ‰±ã£ã¦ã„ã‚‹ â†’ Switchè¦³æˆ¦ã§èª¤èª­ãƒ»æ¬ æãƒ»é…å»¶ãŒå…¥ã‚‹ã¨å´©å£Š

**å¿…è¦ãªæ§‹é€ **:
- **ObservationStateï¼ˆè¦³æ¸¬ï¼‰**: ç”»é¢ã‹ã‚‰èª­ã‚ãŸå€¤ + ä¿¡é ¼åº¦ï¼ˆconfidenceï¼‰
- **BeliefStateï¼ˆä¿¡å¿µï¼‰**: æœªç¢ºå®šæƒ…å ±ï¼ˆæŠ€/æŒã¡ç‰©/ç‰¹æ€§/åŠªåŠ›å€¤/ãƒ†ãƒ©ã‚¹ç­‰ï¼‰ã®å€™è£œåˆ†å¸ƒ

### 1.3 MCTSã®å•é¡Œ

> ã€Œä»Šã®MCTSã¯"åˆ¥ã‚²ãƒ¼ãƒ "ã‚’æ¢ç´¢ã—ã¦ã‚‹ã€‚ç²¾åº¦ã¯ä¸ŠãŒã‚‰ãªã„ã€

- VGCã¯ä¸å®Œå…¨æƒ…å ±ã‚²ãƒ¼ãƒ  â†’ æ¢ç´¢ã‚‚ BeliefState ä¸Šã§è¡Œã†å¿…è¦ãŒã‚ã‚‹
- ç¾çŠ¶ã® `_apply_action` ã¯å®ˆã‚‹/ç¯„å›²æŠ€/å„ªå…ˆåº¦/Sæ“ä½œã‚’å†ç¾ã—ã¦ã„ãªã„

### 1.4 è¦³æˆ¦ã‚·ã‚¹ãƒ†ãƒ ã®è¦ç‚¹

- OCRç²¾åº¦ã‚ˆã‚Šã€Œæ•´åˆæ€§ã§ç›´ã™ã€ãŒå‹ã¡ç­‹
- ã‚¤ãƒ™ãƒ³ãƒˆã‚½ãƒ¼ã‚·ãƒ³ã‚°è¨­è¨ˆãŒå¿…è¦
- äººé–“ã®ä»‹å…¥UIã‚’æœ€åˆã‹ã‚‰å…¥ã‚Œã‚‹

---

## 2. ç¾çŠ¶ã‚³ãƒ¼ãƒ‰ã®å•é¡Œç‚¹

### 2.1 `_convert_battle_to_state()` ã®å•é¡Œ

**ç¾çŠ¶ã®å…¥å‡ºåŠ›**:
```python
def _convert_battle_to_state(self, battle: DoubleBattle) -> BattleState:
    # poke-env ã® Battle ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ BattleState ã‚’ç”Ÿæˆ
```

**ç”Ÿæˆã•ã‚Œã‚‹ BattleState**:
```python
@dataclass
class BattleState:
    player_a: PlayerState      # è‡ªåˆ†å´ï¼ˆç¢ºå®šæƒ…å ±ï¼‰
    player_b: PlayerState      # ç›¸æ‰‹å´ï¼ˆç¢ºå®šã¨ã—ã¦æ‰±ã£ã¦ã„ã‚‹ â† å•é¡Œï¼‰
    turn: int
    weather: Optional[str]
    terrain: Optional[str]
    room: Optional[str]        # ãƒˆãƒªãƒƒã‚¯ãƒ«ãƒ¼ãƒ 
    raw_log: Dict[str, Any]
    legal_actions: Dict[str, List[ActionCandidate]]
    ev_estimates: Dict[str, Dict[str, Any]]  # æœªä½¿ç”¨
```

**å•é¡Œç‚¹**:
| å•é¡Œ | è©³ç´° |
|------|------|
| ç›¸æ‰‹æƒ…å ±ãŒç¢ºå®šæ‰±ã„ | `player_b` ã«æŒã¡ç‰©/åŠªåŠ›å€¤/æŠ€æ§‹æˆã®åˆ†å¸ƒãŒãªã„ |
| ä¿¡é ¼åº¦ãŒãªã„ | è¦³æˆ¦æ™‚ã«OCRçµæœã®ç¢ºã‹ã‚‰ã—ã•ã‚’è¡¨ç¾ã§ããªã„ |
| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å®Ÿæ•°å€¤ãŒãªã„ | `PokemonBattleState` ã« attack/defense ç­‰ãŒãªã„ï¼ˆpoke-envã‹ã‚‰å–å¾—å¯èƒ½ã ãŒæœªä½¿ç”¨ï¼‰ |

### 2.2 `_get_legal_actions()` ã®å•é¡Œ

**ç¾çŠ¶ã®å®Ÿè£…**:
```python
def _get_legal_actions(self, state: BattleState) -> List[TurnAction]:
    # æœ€åˆã®10æ‰‹ã®ã¿è€ƒæ…®
    for candidate in player_a_candidates[:10]:
        action = TurnAction(
            player_a_actions=[Action(...)],
            player_b_actions=[Action(type="move", move_name="tackle")]  # ãƒ€ãƒŸãƒ¼
        )
```

**å•é¡Œç‚¹**:
| å•é¡Œ | è©³ç´° |
|------|------|
| 10æ‰‹ã§æ‰“ã¡åˆ‡ã‚Š | ãƒ€ãƒ–ãƒ«ãƒãƒˆãƒ«ã®çµ„ã¿åˆã‚ã›ã‚’è¡¨ç¾ã§ããªã„ |
| ã‚¿ãƒ¼ã‚²ãƒƒãƒˆç„¡è¦– | `_parse_target()` ãŒå¸¸ã«2ã‚’è¿”ã™ |
| ç›¸æ‰‹è¡Œå‹•ãŒãƒ€ãƒŸãƒ¼ | `player_b_actions` ãŒå¸¸ã« tackle â†’ ç›¸æ‰‹ã®è¡Œå‹•ã‚’è€ƒæ…®ã—ã¦ã„ãªã„ |
| äº¤ä»£å€™è£œãªã— | switchè¡Œå‹•ãŒç”Ÿæˆã•ã‚Œãªã„ |

### 2.3 `_apply_action()` ã®å•é¡Œ

**ç¾çŠ¶ã®å®Ÿè£…**:
- ãƒ€ãƒ¡ãƒ¼ã‚¸è¨ˆç®—ã—ã¦ HP ã‚’æ¸›ã‚‰ã™
- å€’ã‚ŒãŸãƒã‚±ãƒ¢ãƒ³ã‚’é™¤å»

**æœªå®Ÿè£…ã®ãƒ«ãƒ¼ãƒ«**:
| ãƒ«ãƒ¼ãƒ« | é‡è¦åº¦ | ç¾çŠ¶ |
|--------|--------|------|
| å®ˆã‚‹/ãƒ¯ã‚¤ãƒ‰ã‚¬ãƒ¼ãƒ‰/ã‚¯ã‚¤ãƒƒã‚¯ã‚¬ãƒ¼ãƒ‰ | é«˜ | æœªå®Ÿè£… |
| ç¯„å›²æŠ€ã®ãƒ€ãƒ¡ãƒ¼ã‚¸æ¸›è¡°ï¼ˆ0.75å€ï¼‰ | é«˜ | æœªå®Ÿè£… |
| å„ªå…ˆåº¦ã«ã‚ˆã‚‹è¡Œå‹•é †åº | é«˜ | æœªå®Ÿè£…ï¼ˆåŒæ™‚é©ç”¨ï¼‰ |
| è¿½ã„é¢¨/ãƒˆãƒªãƒƒã‚¯ãƒ«ãƒ¼ãƒ ã®ã‚¿ãƒ¼ãƒ³æ¶ˆè²» | ä¸­ | æœªå®Ÿè£… |
| çŠ¶æ…‹ç•°å¸¸ã®é©ç”¨/æ²»ç™’ | ä¸­ | æœªå®Ÿè£… |
| èƒ½åŠ›ãƒ©ãƒ³ã‚¯å¤‰åŒ– | ä¸­ | æœªå®Ÿè£… |
| äº¤ä»£å‡¦ç† | é«˜ | æœªå®Ÿè£… |

---

## 3. å†è¨­è¨ˆæ–¹é‡

### 3.1 äºŒã¤ã®AIã‚·ã‚¹ãƒ†ãƒ ã«åˆ†é›¢

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¯¾æˆ¦AI (Battle AI)                            â”‚
â”‚  - å…¥åŠ›: poke-env Battle ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆç¢ºå®šæƒ…å ±å¤šã„ï¼‰            â”‚
â”‚  - ç›®çš„: å‹ã¤ãŸã‚ã®è¡Œå‹•é¸æŠ                                      â”‚
â”‚  - KPI: å‹ç‡/Elo                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è¦³æˆ¦AI (Spectator AI)                         â”‚
â”‚  - å…¥åŠ›: ç”»é¢ã‚­ãƒ£ãƒ—ãƒãƒ£ï¼ˆèª¤èª­ãƒ»æ¬ æã‚ã‚Šï¼‰                        â”‚
â”‚  - ç›®çš„: å½¢å‹¢åˆ¤æ–­ + è¡Œå‹•äºˆæ¸¬ + èª¬æ˜                              â”‚
â”‚  - KPI: äºˆæ¸¬ç²¾åº¦/ã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³/é…å»¶                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 çŠ¶æ…‹ãƒ¢ãƒ‡ãƒ«ã®äºŒå±¤åŒ–

```python
@dataclass
class ObservationState:
    """ç”»é¢ã‹ã‚‰èª­ã¿å–ã£ãŸè¦³æ¸¬å€¤"""
    pokemon_name: str
    hp_ratio: float
    hp_confidence: float  # OCR/ãƒãƒ¼èª­ã¿å–ã‚Šã®ä¿¡é ¼åº¦
    status_icon: Optional[str]
    displayed_moves: List[str]  # ç”»é¢ã«è¡¨ç¤ºã•ã‚ŒãŸæŠ€
    timestamp: datetime

@dataclass
class BeliefState:
    """ä¸ç¢ºå®šæƒ…å ±ã®åˆ†å¸ƒ"""
    species: str
    # æŒã¡ç‰©å€™è£œã¨ç¢ºç‡
    item_distribution: Dict[str, float]  # {"choicescarf": 0.3, "lifeorb": 0.2, ...}
    # ç´ æ—©ã•ãƒ¬ãƒ³ã‚¸
    speed_range: Tuple[int, int]  # (min, max)
    # æŠ€æ§‹æˆå€™è£œ
    moveset_candidates: List[Tuple[List[str], float]]  # [(æŠ€ãƒªã‚¹ãƒˆ, ç¢ºç‡), ...]
    # åŠªåŠ›å€¤æ¨å®š
    ev_spread_candidates: List[Tuple[Dict[str, int], float]]
```

### 3.3 ç²’å­ãƒ•ã‚£ãƒ«ã‚¿ã«ã‚ˆã‚‹æ¨å®š

```python
@dataclass
class Particle:
    """ç›¸æ‰‹ã®ã€Œå‹ã€ä»®èª¬1ã¤"""
    item: str
    ability: str
    evs: Dict[str, int]
    nature: str
    moveset: List[str]
    tera_type: str
    weight: float = 1.0

class BeliefTracker:
    """ç²’å­ãƒ•ã‚£ãƒ«ã‚¿ã§ç›¸æ‰‹ã®å‹ã‚’æ¨å®š"""
    particles: List[Particle]  # 50-200å€‹
    
    def update(self, observation: ObservationState):
        """è¦³æ¸¬ã¨çŸ›ç›¾ã™ã‚‹ä»®èª¬ã®é‡ã¿ã‚’ä¸‹ã’ã‚‹"""
        # ä¾‹: ãƒ€ãƒ¡ãƒ¼ã‚¸é‡ã‹ã‚‰æŒã¡ç‰©/åŠªåŠ›å€¤ã‚’çµã‚Šè¾¼ã‚€
        # ä¾‹: è¡Œå‹•é †ã‹ã‚‰ç´ æ—©ã•ãƒ¬ãƒ³ã‚¸ã‚’çµã‚Šè¾¼ã‚€
        # ä¾‹: è¡¨ç¤ºæŠ€ã§æŠ€æ§‹æˆã‚’æ›´æ–°
```

### 3.4 ä¸å®Œå…¨æƒ…å ±MCTS (ISMCTS)

```python
def ismcts_search(belief: BeliefState, n_simulations: int):
    """BeliefStateä¸Šã§MCTSæ¢ç´¢"""
    for _ in range(n_simulations):
        # 1. ç²’å­ã‚’1ã¤é¸ã‚“ã§ã€Œç¢ºå®šä¸–ç•Œã€ã¨ã—ã¦å±•é–‹
        particle = sample_particle(belief)
        determinized_state = determinize(belief, particle)
        
        # 2. ã“ã®ç¢ºå®šä¸–ç•Œã§é€šå¸¸ã®MCTS
        result = mcts_rollout(determinized_state)
        
        # 3. çµæœã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆç²’å­å¹³å‡ï¼‰
        update_tree(result)
```

---

## 4. å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

### Phase A: è¦³æˆ¦ã®åœŸå°ï¼ˆä¾¡å€¤ãŒå‡ºã‚‹æœ€çŸ­è·¯ï¼‰

1. **ScreenReader ã‚’ã‚¤ãƒ™ãƒ³ãƒˆæŠ½å‡ºåŒ–**
   - HPãƒãƒ¼é•·ã‹ã‚‰å‰²åˆè¨ˆç®—ï¼ˆOCRã‚ˆã‚Šå®‰å®šï¼‰
   - çŠ¶æ…‹ã‚¢ã‚¤ã‚³ãƒ³æ¤œå‡º
   - å¤©å€™/ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚¢ã‚¤ã‚³ãƒ³
   - ãƒã‚±ãƒ¢ãƒ³ç¨®ã®ç¢ºå®šï¼ˆäººé–“ä»‹å…¥UIä»˜ãï¼‰

2. **ObservationState + confidence å°å…¥**
   - å„è¦³æ¸¬å€¤ã«ä¿¡é ¼åº¦ã‚’ä»˜ä¸
   - ä¿¡é ¼åº¦ä½ã„ã¨ãã¯ã€Œä¸æ˜ã€è¡¨ç¤º

3. **ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ UI æ”¹å–„**
   - å‹ç‡ã§ã¯ãªãã€Œå½¢å‹¢ + è‡ªä¿¡åº¦ã€ã‚’è¡¨ç¤º
   - è‡ªä¿¡åº¦ãŒä½ã„ã¨ãã¯æ–­è¨€ã—ãªã„

### Phase B: BeliefState å°å…¥ï¼ˆç²¾åº¦ãŒè·³ã­ã‚‹ï¼‰

4. **Particle + BeliefTracker å®Ÿè£…**
   - ç²’å­50-200å€‹ã§å‹ä»®èª¬ã‚’ä¿æŒ
   - è¡Œå‹•é †ãƒ»ãƒ€ãƒ¡ãƒ¼ã‚¸é‡ãƒ»è¡¨ç¤ºæŠ€ã§é‡ã¿æ›´æ–°

5. **è¦³æˆ¦UIã«ã€Œèª­ã¿ãŒå‰²ã‚Œã¦ã‚‹ç†ç”±ã€è¡¨ç¤º**
   - ä¾‹: ã€Œã‚¹ã‚«ãƒ¼ãƒ•ã®å¯èƒ½æ€§30%ã€

### Phase C: å¯¾æˆ¦AIã®å¼·åŒ–ï¼ˆå‹ã¦ã‚‹ã‚ˆã†ã«ã™ã‚‹ï¼‰

6. **MCTS â†’ ISMCTS ç§»è¡Œ**
   - BeliefState ä¸Šã§æ¢ç´¢
   - ç²’å­ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã§ç¢ºå®šåŒ–

7. **æåˆˆã‚Šå®Ÿè£…**
   - Top-KæŠ€ï¼ˆ2-4ï¼‰ã®ã¿æ¢ç´¢
   - äº¤ä»£å€™è£œã¯å±€é¢ç›¸æ€§ä¸Šä½ã®ã¿
   - ã‚¿ãƒ¼ã‚²ãƒƒãƒˆä»£è¡¨åŒ–

8. **_apply_action ã®å¼·åŒ–**
   - å®ˆã‚‹/ãƒ¯ã‚¤ãƒ‰ã‚¬ãƒ¼ãƒ‰å®Ÿè£…
   - å„ªå…ˆåº¦ã«ã‚ˆã‚‹è¡Œå‹•é †åº
   - ç¯„å›²æŠ€ãƒ€ãƒ¡ãƒ¼ã‚¸æ¸›è¡°

### Phase D: LLMæ´»ç”¨ï¼ˆè¦³æˆ¦ä¾¡å€¤å‘ä¸Šï¼‰

9. **KAGã§æ ¹æ‹ ã¤ãèª¬æ˜**
   - å›³é‘‘/æŠ€/ç¢ºç‡ã®å‚ç…§ã‚’æ˜ç¤º

10. **ç›¸æ‰‹ã‚¹ã‚¿ã‚¤ãƒ«åˆ†é¡**
    - å®ˆã‚‹å¤šã„/äº¤ä»£å¤šã„ç­‰ã‚’Beliefæ›´æ–°ã«åæ˜ 

---

## å‚è€ƒè³‡æ–™

- [PokeLLMon](https://arxiv.org/abs/2402.01118) - Human-Parity Agent
- [Metamon](https://arxiv.org/abs/2504.04395) - Offline RL with Transformers
- [PokÃ©Champ](https://arxiv.org/abs/2503.04094) - Minimax Language Agent
- [PokÃ©Agent Challenge](https://pokeagent.github.io/) - NeurIPS 2025

---

**ä½œæˆè€…**: Antigravity (AI Assistant)
